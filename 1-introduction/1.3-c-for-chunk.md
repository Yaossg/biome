# 1.3 C for Chunk

## 引子：我的世界

早年的 Minecraft 中文圈子，最常见的一个译名就是**我的世界**。后来随着网易代理，这个名字终于得到了正式承认。不幸的是，网易的所作所为彻底搞臭了这个名字，以至于很多人把“我的世界”和“Minecraft”对立起来，认为是中国版和国际版的象征。作为多年的老玩家，这样的做法我无法认同，但也无可奈何。当然也有老玩家认为，“我的世界”在之前从未被官方承认，不应该作为“真正的 mc 粉丝”所用之语。但我认为既然是粉丝行为，能够被广泛接受，也不存在什么原则问题，是否被官方承认并不重要。

为什么多年前，许多人能普遍认同这个译名？因为它直观的反映了这个游戏带给我们的——一个属于自己的世界。在玩家的讨论中，世界也是非常常见的一个主题，而本文标题中也有个世界两字。然而，**世界（World）**一词，往往指代了许多的概念。

### 「世界」的现实来源

> 四方上下曰宇，往古来今曰宙
>
> ——尸佼《尸子》
>
> 古往今来曰世，上下四方曰界
>
> ——佚名，网络

在我国古代，「宇宙」的概念最先被提出，意为“时空”。而「世界」则源于佛教用语。诸如“大千世界”之类的词也是由此而来。

这两个词语的含义，从最初的边界，逐渐转向代称其中的一切事物。近代之后，宇宙的意思固定位为 universe，而世界的意思固定为了 world。宇宙的含义走向单一，而世界的含义走向多元。

> We are the world, we are the children We are the ones who make a brighter day
>
> ——《We Are The World》

世界一词的多元含义的一个体现在于：与宇宙不同，世界同时也是一个社科概念。在此我不加赘述，相信高中的必修课已经带领各位领略一二。

全世界指的是什么呢？是所有国家？是地球？是宇宙？还是...MC 的一个存档？

### 「世界」在 MC 语境下的多重含义

> Sometimes when they are deep in dreams, I want to tell them, they are building true **worlds** in reality. Sometimes I want to tell them of their importance to the **universe**. Sometimes, when they have not made a true connection in a while, I want to help them to speak the word they fear. 有时当它们深陷梦境中时，我想要告诉它们，它们在现实中创造了真实的**世界**。有时我想告诉它们它们自身对**宇宙**的重要性。有时，当它们和现实失去了联系，我想帮助它们与它们所惧怕的世界交流。
>
> ——《终末之诗》

世界在不同语境有不同的含义：

| 语境 | 含义 | 英文 |
| :--- | :--- | :--- |
| 主世界 | **维度** | **Dimension** |
| 创建新的世界 | **存档** | **Level**/Save |
| 局域网世界 | 服务器 | Server |

有的时候，定语修饰的，也不是同一个“世界”。

| 语境 | 含义 | 英文 |
| :--- | :--- | :--- |
| 世界类型： 超平坦世界 | **存档的**类型，决定了 一个**维度**（主世界）的生物群系来源 | WorldType BiomeSource |
| 沙漠世界 | 一个**维度**（主世界）的生物群系 | Biome |
| 创造世界 | **玩家的**游戏模式 或（尤指**服务器的**）**存档的**默认游戏模式 | Gamemode |
| 极限世界 | **存档的**一个属性 | Hardcore |
| 和平世界 | **存档的**一个属性 | Difficulty |
| 死亡不掉落的世界 | **存档的**一个游戏规则 | Gamerule |
| 世界边界 | **存档（决定）的**每个**维度的**边界 | WorldBorder |
| 世界生成 | **存档（决定）的**每个**维度的**生成 |  |
| 向局域网开放 | 成为**服务器** |  |

一个世界可以同时是极限、和平、创造、死亡不掉落的吗？当然可以！但是他们的含义实际上各不相同，因此用“世界”一词可能歧义很大。

在接下来的文章里面，如果是特指，我会避免使用“世界”一词，但是如果是用它来概括这方面的内容，正是因为它的多义性，反而再合适不过。

### 世界的构成

> 这次Mojang代码的重构采用了全新的设计模式，增加了代码的可扩展性，主要体现在：
>
> * 将世界生成的功能被集中在了**区块生成器和生物群系**两部分上面，而不是离散在方方面面，更便于对代码之间的关系进行分析。
>
> ——Yaossg《浅析1.13世界生成》

1. 存档（原版包含三个维度）
2. 维度（包含约 117187.5 x 117187.5 个区域，即 60M x 256 x 60M 约为 1018 个方块）
3. 区域（包含 32 x 32 个区块）
4. 区块（包含 4 x 64 x 4 个区元，即 16 x 256 x 16 个方块）
5. 区元（包括 4 x 4 x 4 个方块）
6. 方块

从上往下看，维度决定了世界生成，实际上就是由它提供的**区块生成器**和**生物群系来源**。从下往上看，区块、区元承载了世界生成，构成了整个世界。这一节和下一节将分别介绍_后者_和_前者_，和他们与生物群系生成之间的关系。

## 区元

> I used to rule the world 我曾统治这世界
>
> **Chunks** world load when I gave the word 广阔的世界在我的命令下运转
>
> ——《Fallen Kingdom》

无论是否与世界生成有关，在各种场合，**区块（Chunk）**这个概念总是被经常提及——好像世界就应该这么分一样（不然你看标题~~才不是为了让标题凑出 ABCD 呢~~）。然而其实还有很多有关世界生成的大小分块。比如：**区元（Area）**是 MC 生成生物群系的最小单位。

### 区元命名杂谈

这是一个从未被公开提出的概念，可以说是这篇文章的首创了。当时在翻译 Area 时，我不假思索的用了“区域”一词。这本来无可厚非，Area 最常见的翻译就是这个。然而当我意识到它与已有的一个概念——**区域（Region）**，撞车的时候，已经有一段时间了。为此，我当时不得不在文章里写到

> **注意：Region（32 x 32 区块）的翻译也是“区域”。本文无特别说明区域均指 Area，请勿混淆。**

后来觉得这样欠妥，决定还是换个名字。作为生物群系生成的最小单位，作为世界生成中用到的最小的方块集合，也就是最小的一个“区”的概念，“元”一字它当之无愧。

不过此名字一处，便遭各路嘲讽——这分明就是“屈原”嘛。是这样的，对此屈原也很恼火。我最喜欢屈原的一句话是

> 路漫漫其修远兮，吾将上下而求索
>
> ——屈原《离骚》

说实话，写这个教程，何尝不是一个“上下求索”的过程呢？举目四望，路，我的路还漫长着呢。梦想总是遥不可及，而现实触手可得，但

> 举目见日，不见长安
>
> ——晋明帝语，《世说新语》

有时候现实残酷反而把人推向梦想那一边。可梦是做不完的，无尽的梦终究会成为无谓的梦。有时候香肠是一位理想主义者，幻想着心中的长安。但有时候又是一位现实主义者，因为永远也到不了长安。香肠正陷于这无尽的矛盾之中。是不是感觉一头雾水，香肠的梦是什么？也许我应该找个机会单独谈谈，囿于篇幅限制就不在此过多展开了。

### 区元的来历与去路

在 1.15 之前，每个区块的生物群系被储存在一个大小为 16 x 16 的数组里面，储存了区块内每一个 1 x 1 x 256 的生物群系。

1.15 更新之后，每个区块的生物群系被储存在一个大小为 4 x 4 x 64 的数组里面，数组里的每一个元素，代表的是一个区域里的生物群系，至于每个方块的生物群系，会动态地计算。

尽管加入了高度支持，但目前所有的生物群系来源生成得到的 x 和 z 相同而 y 不同的区域仍然总是包含相同的生物群系；真正高度上的差别是体现在最后打磨后的，方块尺度上的。不过希望还是要有，我们离 3D 生物群系的支持实际上只差一步之遥。在多重噪声生物群系来源代码中，有一个 boolean 值，直接决定是否让 y 参与计算。目前它_永远_为 false，不过我相信一定不会_永远_为 false 的。

在接下来的叙述中，本文用`x, z`这样的二元组来表示 x 和 z 相同的 16 个区域的坐标，其他（如方块、区块、区域）的坐标会另做说明。

## 区块生成器

**区块生成器（ChunkGenerator）**，是之前已经提到的，两大非常重要的世界生成提供者之一。

